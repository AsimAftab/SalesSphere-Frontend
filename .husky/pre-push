export NODE_OPTIONS="--max-old-space-size=4096"

# 1. Run unit tests
echo "ğŸ§ª Running unit tests..."
if ! npx vitest run; then
  echo ""
  echo "âŒ Tests failed! Push aborted."
  echo "   Fix the failing tests shown above, then try pushing again."
  echo "   To skip this check (not recommended): git push --no-verify"
  exit 1
fi

# 2. Build check
echo "ğŸ”¨ Running build check before push..."
if ! npm run build; then
  echo ""
  echo "âŒ Build failed! Push aborted."
  echo "   Fix the build errors shown above, then try pushing again."
  echo "   To skip this check (not recommended): git push --no-verify"
  exit 1
fi

echo "âœ… All pre-push checks passed! Pushing..."
